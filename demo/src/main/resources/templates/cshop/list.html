<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/basicLayout}">
  <!-- 전체 본문내용 -->
<div class="site-section" id="properties-section"
style="background: white" layout:fragment="content">
<link rel="stylesheet" th:href="@{/css/animate.css}">
<link rel="stylesheet" th:href="@{/css/cshop.css}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<section class="site-section" id="about-section">
		<div class="row">
			<!-- ******************************카테고리 영역 **************************************************** -->
			<div class="col-md-3 mb-3 mb-md-0 category">
				<div
					class="sidebar-box bg-white p-4 ftco-animate fadeInUp ftco-animated cateboxes">
					<h3 class="heading-sidebar">Search</h3>
					<form action="#" class="search-form mb-3">
						<select class="form-control col-md-3">
							<option class="form-control">제목</option>
							<option class="form-control">내용</option>
							<option class="form-control">작성자</option>
						</select>
						<div class="form-group">
							<span class="icon icon-search"></span> <input type="text"
								class="form-control" placeholder="Search...">
						</div>
					</form>
				</div>
				<div
					class="sidebar-box bg-white p-4 ftco-animate fadeInUp ftco-animated cateboxes"
					style="width: 100%">
					<h3 class="heading-sidebar">Category</h3>
					<form action="#" class="browse-form">
						<label for="option-job-1"><input type="checkbox"
							id="option-job-1" name="vehicle" value="" checked="">
							Java</label><br> <label for="option-job-2"><input
							type="checkbox" id="option-job-2" name="vehicle" value="">
							SQL </label><br> <label for="option-job-3"><input
							type="checkbox" id="option-job-3" name="vehicle" value="">
							JavaScript</label><br> <label for="option-job-4">
					</form>
				</div>
				<div
					class="sidebar-box bg-white p-4 ftco-animate fadeInUp ftco-animated cateboxes"
					style="width: 100%">
					<h3 class="heading-sidebar">Price</h3>
					<form action="#" class="browse-form">
						<label for="option-location-1"><input type="checkbox"
							id="option-location-1" name="vehicle" value="" checked="">
							10,000원 이하</label><br> <label for="option-location-2">
							<input
							type="checkbox" id="option-location-2" name="vehicle" value="">
							10,000원 ~ 100,000원 </label><br> <label for="option-location-3">
							<input
							type="checkbox" id="option-location-3" name="vehicle" value="">
							110,000원 ~ 200,000원</label><br> <label for="option-location-4">
							<input
							type="checkbox" id="option-location-4" name="vehicle" value="">
							210,000원 ~ 300,000원</label><br> <label for="option-location-5">
							<input
							type="checkbox" id="option-location-5" name="vehicle" value="">
							210,000원 이상</label>
					</form>
				</div>
				<div
					class="sidebar-box bg-white p-4 ftco-animate fadeInUp ftco-animated cateboxes"
					style="width: 100%">
					<h3 class="heading-sidebar">Grade</h3>
					<form action="#" class="browse-form">
						<label for="option-job-type-1"><input type="checkbox"
							id="option-job-type-1" name="vehicle" value="" checked="">
							1</label><br> <label for="option-job-type-2"><input
							type="checkbox" id="option-job-type-2" name="vehicle" value="">
							2</label><br> <label for="option-job-type-3"><input
							type="checkbox" id="option-job-type-3" name="vehicle" value="">
							3</label><br> <label for="option-job-type-4"><input
							type="checkbox" id="option-job-type-4" name="vehicle" value="">
							4</label><br> <label for="option-job-type-5">
					</form>
				</div>

				<div
					class="sidebar-box bg-white p-4 ftco-animate fadeInUp ftco-animated cateboxes"
					style="width: 100%">
					<h3 class="heading-sidebar">등록 날짜</h3>
					<form action="#" class="browse-form">
						<input type="date" class="form-control"> ~
						<input type="date" class="form-control">
					</form>
				</div>
			</div>
			<!-- ******************************카테고리 영역 끝 **************************************************** -->
			<!-- ********************본문시작************************* -->
			<div class="col-md-9 mb-9 mb-md-0 content">
				<div class="order-btn">
					<span><b>&nbsp;&nbsp;&nbsp;</b></span>
					<a href="price">가격순</a>
					<a href="avg">평점순</a>
					<a href="cnt">리뷰개수</a>
					<a href="date">날짜</a>
					<a href="hit">조회수</a>
				</div>

				<div class="product-item-div">
				
				</div>
				
				<br><br>
				<div class="page-div cshop-page-div">
					<nav aria-label="Page navigation example">
					<ul class="pagination">
						<li th:if="${pm.prev}" class="page-item">
							<a class="page-link" href="#" aria-label="Previous">
							<span aria-hidden="true">&laquo;</span>
							</a>
						</li>

						<li th:classappend="${pm.paging.page == num} ? active" th:each="num : ${#numbers.sequence(pm.start,pm.end)}" class="page-item page-btn">
							<a th:text="${num}" class="page-link" th:href="${num}"></a>
						</li>

						<li th:if="${pm.next}" class="page-item">
							<a class="page-link" href="#" aria-label="Next">
								<span aria-hidden="true">&raquo;</span>
							</a>
						</li>
					</ul>
					</nav>
				</div>
			</div>
			</div>
		</section>
		<form id="pmForm" method="get">
			<input type="hidden" name="page" value="${pm.paging.page}" />
			<input type="hidden" name="amount" value="${pm.paging.amount}" />
			<!-- <input type="hidden" name="type" value="${pm.paging.type}" />
			<input type="hidden" name="keyword" value="${pm.paging.keyword}" /> -->
			<input type="hidden" name="orderType" value="pno" />
		</form>
		<script>
			$(document).ready(function() {
				var $pmForm = $('#pmForm');

				showList($('input[name="orderType"]').val(), 1, 12);

				$('.page-btn a').on('click', function(e) {
					e.preventDefault();
					var pageNum = $(this).attr('href');
					console.log(pageNum);
					console.log($(this).parent().siblings());
					$(this).parent().siblings().removeClass('active');
					$(this).parent().addClass('active');
					showList($('input[name="orderType"]').val(), pageNum, 12);
				});

				$('.order-btn a').on('click', function(e) {
					e.preventDefault();
					var orderType = $(this).attr('href');
					console.log(orderType);
					$('input[name="orderType"]').val(orderType);
					showList(orderType);
				});

				var $pItemDiv = $('.product-item-div');
				

				function showList(orderType, page, amount) {
					$.ajax({
           			type:"get",
           			url:"/cshop/listData",
           			data : {
						   orderType: orderType, 
						   page: page, 
						   amount: amount
						   },
           			success:function(data){
						var str = "";
						console.log(data.length);
						for (var i=0; i < data.length; i++)  {
							// 가격순 평점순 리뷰개수 날짜 조회수
							str += '<div class="card" style="width: 18rem;">';
								
								str += '<img src="/images/';
								if (data[i].ctno === 1) {
									str += 'java';
								} else if (data[i].ctno === 2) {
									str += 'sql';
								} else if (data[i].ctno === 3) {
									str += 'jsfile';
								} else if (data[i].ctno === 4) {
									str += 'java';
								}

								str += '.png" class="card-img-top" alt="...">';

							str += '<div class="card-body">';
								str += '<hr>';
								str += '<h5 class="card-title">'+ data[i].pname +'</h5>';
								str += '<h6>'+ data[i].seller +'</h6>';
							str += '</div>';
							str += '<ul class="list-group list-group-flush">';
								str += '<li class="list-group-item">';
								str += '<img src="/images/money-bag.png" class="moneyIcon" alt="...">';
								str += '<p class="money">가격' + data[i].price + '</p>원</li>';
							str += '</ul>';
							str += '<div class="card-body">';
								str += '<p class="card-text">' + data[i].summary + '</p>';
							str += '</div>';
							str += '<ul class="list-group list-group-flush eval">';
								str += '<li class="list-group-item">';
									str += '<img src="/images/star.png" class="starIcon" alt="...">';
									str += '<small class="rate">' + data[i].review.ravg + '</small> |';
									str += ' <small><span>' + data[i].review.rcnt + '</span>개의 평가</small>';
								str += '</li>';
							str += '</ul>';
							str += '</div>';

							
						}

						$pItemDiv.html(str);
						
           			},error:function(request,status,error){
           				alert("error");
           			}
           			}); 
				}

			


			});

			
		</script>
	</div>
<!-- 본문 -->	